# Developer B Phaser å ´æ™¯å®Œæ•´å­¸ç¿’å ±å‘Š

> é–‹ç™¼è€…ï¼šDeveloper B
> æ—¥æœŸï¼š2025-12-18
> æ¶µè“‹ç¯„åœï¼šæ‰€æœ‰ Phaser ç›¸é—œä»»å‹™ (T023-T025, T060-T062, T072)

---

## 1. ä»»å‹™å®Œæˆç¸½è¦½

| ä»»å‹™ç·¨è™Ÿ | èªªæ˜ | æª”æ¡ˆè·¯å¾‘ | ç‹€æ…‹ |
|---------|------|----------|------|
| T023 | EventBridge é€šè¨Šæ¨¡çµ„ | `components/phaser/EventBridge.ts` | âœ… å®Œæˆ |
| T024 | PhaserGame éŠæˆ²å¯¦ä¾‹ | `components/phaser/PhaserGame.tsx` | âœ… å®Œæˆ |
| T025 | PhaserContainer æ‡¶è¼‰å…¥ | `components/phaser/PhaserContainer.tsx` | âœ… å®Œæˆ |
| T060 | DrawScene æŠ½å–å‹•ç•« | `components/phaser/scenes/DrawScene.ts` | âœ… å®Œæˆ |
| T061 | CardRevealScene å¡ç‰‡æ­ç¤º | `components/phaser/scenes/CardRevealScene.ts` | âœ… å®Œæˆ |
| T062 | PreloadScene è³‡æºè¼‰å…¥ | `components/phaser/scenes/PreloadScene.ts` | âœ… å®Œæˆ |
| T072 | CelebrationScene æ…¶ç¥å ´æ™¯ | `components/phaser/scenes/CelebrationScene.ts` | âœ… å®Œæˆ |

---

## 2. æ¶æ§‹è¨­è¨ˆ

### 2.1 æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         React å±¤                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ DrawSection â”‚  â”‚ DrawResult  â”‚  â”‚ Other Components    â”‚  â”‚
â”‚  â”‚   .tsx      â”‚  â”‚ Overlay.tsx â”‚  â”‚                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                â”‚                                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                  â†“                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                EventBridge (å–®ä¾‹)                      â”‚  â”‚
â”‚  â”‚   emit() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Phaser                        â”‚  â”‚
â”‚  â”‚   on() / trigger() â†â”€â”€ Phaser                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Phaser å±¤                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   PhaserGame.tsx                     â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚              Phaser.Game å¯¦ä¾‹                â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å ´æ™¯ç®¡ç†                          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚ Preload â”‚ â†’ â”‚ DrawScene â”‚ â†’ â”‚ CardReveal    â”‚   â”‚   â”‚
â”‚  â”‚   â”‚ Scene   â”‚   â”‚           â”‚   â”‚ Scene         â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                         â†“            â”‚   â”‚
â”‚  â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚                               â”‚ Celebration   â”‚      â”‚   â”‚
â”‚  â”‚                               â”‚ Scene         â”‚      â”‚   â”‚
â”‚  â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å ´æ™¯æµç¨‹

```
ä½¿ç”¨è€…æ“ä½œ                 Phaser å ´æ™¯               React ç‹€æ…‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

é»æ“Šã€ŒæŠ½å–ã€        â”€â”€â”€â†’ PreloadScene (è¼‰å…¥è³‡æº)
                         â”‚
                         â†“
phase: 'drawing'   â†â”€â”€â”€ DrawScene (æŠ½å¡å‹•ç•«)
                         â”‚  - å¡ç‰‡é£›å…¥ (1s)
                         â”‚  - ç²’å­èšé›† (1.5s)
                         â”‚  - 3D ç¿»è½‰ (0.8s)
                         â”‚  - ç¨€æœ‰åº¦çˆ†ç™¼ (1s)
                         â”‚
                         â†“ DRAW_COMPLETE äº‹ä»¶
phase: 'revealing' â†â”€â”€â”€ CardRevealScene (æŒçºŒå±•ç¤º)
                         â”‚  - å¡ç‰‡æµ®å‹•
                         â”‚  - å…‰ç’°å‹•ç•«
                         â”‚  - ç’°ç¹ç²’å­
                         â”‚
                         â†“ CARD_REVEALED äº‹ä»¶
phase: 'result'    â†â”€â”€â”€ (å ´æ™¯åœæ­¢)
                         â”‚
                         â†“ ä½¿ç”¨è€…é»æ“Šã€Œé‘„é€  NFTã€
phase: 'minting'   â”€â”€â”€â†’ CelebrationScene (æ…¶ç¥å‹•ç•«)
                         â”‚  - ç…™ç«çˆ†ç™¼
                         â”‚  - é‡‘å¹£é£›æ•£
                         â”‚  - æ˜Ÿæ˜Ÿç‘è½
                         â”‚
                         â†“ CELEBRATION_DONE äº‹ä»¶
phase: 'complete'  â†â”€â”€â”€ (å ´æ™¯åœæ­¢)
```

---

## 3. æ ¸å¿ƒæŠ€è¡“å¯¦ä½œ

### 3.1 EventBridge å–®ä¾‹æ¨¡å¼

```typescript
export class EventBridge {
  private static instance: EventBridge;
  private listeners: Record<string, Array<(data: unknown) => void>>;
  private game: Phaser.Game | null;

  private constructor() {
    this.listeners = {};
    this.game = null;
  }

  static getInstance(): EventBridge {
    if (!EventBridge.instance) {
      EventBridge.instance = new EventBridge();
    }
    return EventBridge.instance;
  }

  // React â†’ Phaser
  emit(eventName: string, data: unknown): void {
    this.game?.scene.scenes.forEach((scene) => {
      if (scene.scene.isActive()) {
        scene.events.emit(eventName, data);
      }
    });
  }

  // Phaser â†’ React
  trigger(eventName: string, data: unknown): void {
    this.listeners[eventName]?.forEach((cb) => cb(data));
  }
}
```

**è¨­è¨ˆå„ªé»**ï¼š
- è§£è€¦ React èˆ‡ Phaser æ¡†æ¶
- æ”¯æ´é›™å‘é€šè¨Š
- äº‹ä»¶æ—¥èªŒè¨˜éŒ„ä¾¿æ–¼é™¤éŒ¯

### 3.2 å‹•æ…‹æè³ªç”Ÿæˆ

ä¸éœ€è¦å¤–éƒ¨åœ–ç‰‡ï¼Œä½¿ç”¨ Graphics API ç”Ÿæˆï¼š

```typescript
// åœ“å½¢ç²’å­
private createCircleParticle(): void {
  const graphics = this.add.graphics();
  graphics.fillStyle(0xffffff, 1);
  graphics.fillCircle(16, 16, 16);
  graphics.generateTexture('particle', 32, 32);
  graphics.destroy();  // é‡è¦ï¼šç”Ÿæˆå¾ŒéŠ·æ¯€
}

// äº”è§’æ˜Ÿç²’å­
private createStarParticle(): void {
  const graphics = this.add.graphics();
  graphics.fillStyle(0xffffff, 1);

  const spikes = 5;
  const outerRadius = 14;
  const innerRadius = 6;

  graphics.beginPath();
  for (let i = 0; i < spikes * 2; i++) {
    const radius = i % 2 === 0 ? outerRadius : innerRadius;
    const angle = (Math.PI / spikes) * i - Math.PI / 2;
    const x = 16 + Math.cos(angle) * radius;
    const y = 16 + Math.sin(angle) * radius;

    if (i === 0) graphics.moveTo(x, y);
    else graphics.lineTo(x, y);
  }
  graphics.closePath();
  graphics.fillPath();
  graphics.generateTexture('star', 32, 32);
  graphics.destroy();
}
```

**å„ªé»**ï¼š
- é›¶å¤–éƒ¨è³‡æºä¾è³´
- æ¸›å°‘è¼‰å…¥æ™‚é–“
- å¯å‹•æ…‹èª¿æ•´é¡è‰²ã€å¤§å°

### 3.3 Phaser 3.60+ ç²’å­ç³»çµ±

```typescript
// æ–°ç‰ˆ API (Phaser 3.60+)
const emitter = this.add.particles(x, y, 'particle', {
  speed: { min: 100, max: 200 },
  angle: { min: 0, max: 360 },
  scale: { start: 0.5, end: 0 },
  alpha: { start: 1, end: 0 },
  lifespan: 1500,
  frequency: 30,
  tint: 0x60a5fa,
  blendMode: Phaser.BlendModes.ADD,
});

// çˆ†ç™¼æ•ˆæœï¼ˆä¸€æ¬¡æ€§ç™¼å°„ï¼‰
emitter.explode(50);

// ç§»å‹•åˆ°ç›®æ¨™ï¼ˆèƒ½é‡èšé›†æ•ˆæœï¼‰
const emitter = this.add.particles(x, y, 'particle', {
  emitZone: {
    type: 'edge',
    source: new Phaser.Geom.Rectangle(0, 0, width, height),
  },
  moveToX: centerX,
  moveToY: centerY,
});
```

### 3.4 Tween å‹•ç•«ç³»çµ±

```typescript
// åŸºç¤å‹•ç•«
this.tweens.add({
  targets: card,
  y: targetY,
  duration: 1000,
  ease: 'Back.easeOut',
});

// å¾ªç’°å‹•ç•«
this.tweens.add({
  targets: glow,
  alpha: { from: 0.3, to: 0.6 },
  scale: { from: 1, to: 1.1 },
  duration: 2000,
  yoyo: true,
  repeat: -1,  // ç„¡é™å¾ªç’°
});

// 3D ç¿»è½‰æ•ˆæœï¼ˆä½¿ç”¨ scaleXï¼‰
this.tweens.add({
  targets: card,
  scaleX: { from: 1, to: 0 },
  duration: 400,
  ease: 'Sine.easeInOut',
  onComplete: () => {
    this.tweens.add({
      targets: card,
      scaleX: { from: 0, to: 1 },
      duration: 400,
    });
  },
});
```

---

## 4. å ´æ™¯è©³ç´°èªªæ˜

### 4.1 PreloadScene - è³‡æºé è¼‰å…¥

**è·è²¬**ï¼š
- è¼‰å…¥æ‰€æœ‰ç²’å­æè³ª
- é¡¯ç¤ºè¼‰å…¥é€²åº¦
- é€šçŸ¥ React æº–å‚™å°±ç·’

**ç”Ÿå‘½é€±æœŸ**ï¼š
```
preload() â†’ ç”Ÿæˆæè³ªã€ç›£è½é€²åº¦
    â†“
create() â†’ æ¸…ç† UIã€ç™¼é€ SCENE_READYã€è¨­å®šç›£è½å™¨
    â†“
ç­‰å¾… START_DRAW äº‹ä»¶ â†’ å•Ÿå‹• DrawScene
```

**å‹•æ…‹æè³ª**ï¼š
| åç¨± | å°ºå¯¸ | ç”¨é€” |
|------|------|------|
| `particle` | 32Ã—32 | åŸºç¤åœ“å½¢ç²’å­ |
| `star` | 32Ã—32 | äº”è§’æ˜Ÿç²’å­ |
| `glow` | 64Ã—64 | å…‰æšˆç²’å­ |

### 4.2 DrawScene - æŠ½å–å‹•ç•«

**æ™‚é–“è»¸**ï¼š
```
0s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3.5s
â”‚                                                  â”‚
â”‚ [å¡ç‰‡é£›å…¥] 1s                                    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                     â”‚
â”‚                                                  â”‚
â”‚ [ç²’å­èšé›†] 1.5s                                  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
â”‚                                                  â”‚
â”‚           [ç¿»è½‰] 0.8s                            â”‚
â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
â”‚                                                  â”‚
â”‚                  [çˆ†ç™¼] 1s                       â”‚
â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚                                                  â”‚
â”‚                             [æ·¡å‡º] 0.5s          â”‚
â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹æ•ˆå…ƒä»¶**ï¼š
1. èƒŒæ™¯å…‰æšˆï¼ˆå¾ªç’°å‘¼å¸ï¼‰
2. å¡ç‰Œå®¹å™¨ï¼ˆé‚Šæ¡†ç™¼å…‰ï¼‰
3. èƒ½é‡ç²’å­ï¼ˆå¾é‚Šç·£èšé›†åˆ°ä¸­å¿ƒï¼‰
4. 3D ç¿»è½‰ï¼ˆscaleX æ¨¡æ“¬ï¼‰
5. ç¨€æœ‰åº¦çˆ†ç™¼ï¼ˆå…‰èŠ’ + æ˜Ÿæ˜Ÿç²’å­ï¼‰

### 4.3 CardRevealScene - å¡ç‰‡æ­ç¤º

**æŒçºŒæ•ˆæœ**ï¼š
- å¡ç‰‡è¼•å¾®æµ®å‹•ï¼ˆç„¡é™å¾ªç’°ï¼‰
- å¤šå±¤å…‰ç’°å‘¼å¸æ•ˆæœ
- ç’°ç¹ç²’å­ï¼ˆæ ¹æ“šç¨€æœ‰åº¦èª¿æ•´å¯†åº¦ï¼‰
- ç¨€æœ‰åº¦å°ˆå±¬ç‰¹æ•ˆ

**ç¨€æœ‰åº¦å·®ç•°**ï¼š
| ç¨€æœ‰åº¦ | ç²’å­é »ç‡ | å°ˆå±¬æ•ˆæœ |
|--------|----------|----------|
| Common | 150ms | ç„¡ |
| Rare | 100ms | ç„¡ |
| Epic | 80ms | ç´«è‰²èƒ½é‡æ³¢ |
| Legendary | 50ms | é‡‘è‰²æ—‹è½‰å…‰ç·š + æ˜Ÿæ˜Ÿç’°ç¹ |

### 4.4 CelebrationScene - æ…¶ç¥å ´æ™¯

**æ™‚é–“è»¸**ï¼š
```
0s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4s
â”‚                                                 â”‚
â”‚ [èƒŒæ™¯é–ƒå…‰] 0.3s Ã— 3                             â”‚
â”‚ â”œâ”€â”€â”¤                                            â”‚
â”‚                                                 â”‚
â”‚ [ä¸­å¤®çˆ†ç™¼] 0.8s                                 â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤                                      â”‚
â”‚                                                 â”‚
â”‚ [ç…™ç«åºåˆ—] 0-1.5s                               â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
â”‚   â†‘   â†‘   â†‘   â†‘   â†‘  (æ¯ 0.3s)                â”‚
â”‚                                                 â”‚
â”‚ [é‡‘å¹£é£›æ•£] 0-1s                                 â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚                                                 â”‚
â”‚ [æ˜Ÿæ˜Ÿç‘è½] 0.5s-3.5s                            â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚                                                 â”‚
â”‚ [æˆåŠŸæ–‡å­—] 0.3s-æŒçºŒ                            â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹æ•ˆå…ƒä»¶**ï¼š
1. èƒŒæ™¯é–ƒå…‰ï¼ˆä¾†å›é–ƒçˆï¼‰
2. ä¸­å¤®å…‰ç’°çˆ†ç™¼ï¼ˆå¤šå±¤ï¼‰
3. ç…™ç«ç³»çµ±ï¼ˆä¸Šå‡ + çˆ†ç™¼ï¼‰
4. é‡‘å¹£é£›æ•£ï¼ˆæ‹‹ç‰©ç·šè»Œè·¡ï¼‰
5. æ˜Ÿæ˜Ÿç‘è½ï¼ˆæŒçºŒ 3 ç§’ï¼‰
6. æˆåŠŸæ–‡å­—ï¼ˆæµ®å‹•å‹•ç•«ï¼‰

---

## 5. è¨­è¨ˆæ¨¡å¼ç¸½çµ

### 5.1 Container æ¨¡å¼

```typescript
const card = this.add.container(x, y);
const bg = this.add.rectangle(0, 0, 200, 280, 0x1a1a1a);
const icon = this.add.text(0, 0, 'ğŸ“–', { fontSize: '80px' });

card.add([bg, icon]);
card.setData('icon', icon);  // å„²å­˜åƒè€ƒ
```

### 5.2 å»¶é²åŸ·è¡Œæ¨¡å¼

```typescript
create() {
  this.animateCardEntry();

  this.time.delayedCall(1200, () => {
    this.animateCardFlip();
  });

  this.time.delayedCall(2000, () => {
    this.createRarityBurst();
  });
}
```

### 5.3 ç‹€æ…‹é˜²è­·æ¨¡å¼

```typescript
private isCompleted: boolean = false;

private onComplete(): void {
  if (this.isCompleted) return;
  this.isCompleted = true;
  // åªåŸ·è¡Œä¸€æ¬¡
}
```

### 5.4 è³‡æºæ¸…ç†æ¨¡å¼

```typescript
shutdown(): void {
  this.events.off(EVENTS.STOP_SCENE, this.stopScene, this);
}
```

---

## 6. æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

### 6.1 ç²’å­æ•¸é‡æ§åˆ¶

```typescript
// æ ¹æ“šç¨€æœ‰åº¦èª¿æ•´
const frequencyMap = {
  Common: 150,    // è¼ƒå°‘
  Rare: 100,
  Epic: 80,
  Legendary: 50,  // æœ€å¤š
};

// è¨­å®šæœ€å¤§ç²’å­æ•¸
const emitter = this.add.particles(x, y, 'particle', {
  maxParticles: 100,
  lifespan: 1500,
});
```

### 6.2 åŠæ™‚éŠ·æ¯€

```typescript
// å®Œæˆå¾ŒéŠ·æ¯€ emitter
this.time.delayedCall(3000, () => {
  emitter.destroy();
});

// Tween å®Œæˆå¾ŒéŠ·æ¯€ç‰©ä»¶
this.tweens.add({
  targets: flash,
  onComplete: () => flash.destroy(),
});
```

### 6.3 æ‡¶è¼‰å…¥

```tsx
// Next.js å‹•æ…‹è¼‰å…¥ï¼ˆç´„ 1.5MBï¼‰
const PhaserGame = dynamic(() => import('./PhaserGame'), {
  ssr: false,
  loading: () => <LoadingSpinner />,
});
```

---

## 7. å¸¸è¦‹é™·é˜±èˆ‡è§£æ±ºæ–¹æ¡ˆ

### 7.1 ç²’å­æœªéŠ·æ¯€

```typescript
// âŒ éŒ¯èª¤
const emitter = this.add.particles(x, y, 'particle', {...});
// ç²’å­æœƒä¸€ç›´å­˜åœ¨

// âœ… æ­£ç¢º
this.time.delayedCall(3000, () => {
  emitter.destroy();
});
```

### 7.2 å ´æ™¯è³‡æ–™éºå¤±

```typescript
// âŒ éŒ¯èª¤
constructor() {
  this.rarity = 'Common';  // é‡å•Ÿæ™‚ä¸æœƒæ›´æ–°
}

// âœ… æ­£ç¢º
init(data) {
  this.rarity = data.rarity || 'Common';
}
```

### 7.3 äº‹ä»¶ç›£è½ç´¯ç©

```typescript
// âŒ éŒ¯èª¤
create() {
  bridge.on(EVENTS.STOP, this.stop, this);
}

// âœ… æ­£ç¢º
shutdown() {
  bridge.off(EVENTS.STOP, this.stop, this);
}
```

### 7.4 å ´æ™¯åˆ‡æ›æ™‚æ©Ÿ

```typescript
// âŒ éŒ¯èª¤ï¼šç«‹å³åˆ‡æ›ï¼ˆç„¡éæ¸¡ï¼‰
this.scene.start('NextScene');

// âœ… æ­£ç¢ºï¼šæ·¡å‡ºå¾Œåˆ‡æ›
this.cameras.main.fadeOut(500);
this.cameras.main.once('camerafadeoutcomplete', () => {
  this.scene.start('NextScene', data);
});
```

---

## 8. æª”æ¡ˆçµæ§‹

```
frontend/components/phaser/
â”œâ”€â”€ EventBridge.ts          # React â†” Phaser é€šè¨Š
â”œâ”€â”€ PhaserGame.tsx          # Phaser.Game ç®¡ç†
â”œâ”€â”€ PhaserContainer.tsx     # æ‡¶è¼‰å…¥å®¹å™¨
â””â”€â”€ scenes/
    â”œâ”€â”€ index.ts            # å ´æ™¯ç´¢å¼•
    â”œâ”€â”€ PreloadScene.ts     # è³‡æºé è¼‰å…¥
    â”œâ”€â”€ DrawScene.ts        # æŠ½å–å‹•ç•«
    â”œâ”€â”€ CardRevealScene.ts  # å¡ç‰‡æ­ç¤º
    â””â”€â”€ CelebrationScene.ts # æ…¶ç¥å ´æ™¯
```

---

## 9. äº‹ä»¶å¸¸æ•¸

```typescript
export const EVENTS = {
  // React â†’ Phaser
  START_DRAW: 'START_DRAW',
  REVEAL_CARD: 'REVEAL_CARD',
  START_CELEBRATION: 'START_CELEBRATION',
  STOP_SCENE: 'STOP_SCENE',

  // Phaser â†’ React
  DRAW_COMPLETE: 'DRAW_COMPLETE',
  CARD_REVEALED: 'CARD_REVEALED',
  CELEBRATION_DONE: 'CELEBRATION_DONE',
  SCENE_READY: 'SCENE_READY',
};
```

---

## 10. ç¨€æœ‰åº¦è¦–è¦ºç³»çµ±

| ç¨€æœ‰åº¦ | é¡è‰² (Hex) | RGB | ä¸­æ–‡å |
|--------|------------|-----|--------|
| Common | 0x9ca3af | ç°è‰² | æ™®é€š |
| Rare | 0x60a5fa | è—è‰² | ç¨€æœ‰ |
| Epic | 0xa78bfa | ç´«è‰² | å²è©© |
| Legendary | 0xd4af37 | é‡‘è‰² | å‚³èªª |

---

## 11. å»¶ä¼¸å­¸ç¿’è³‡æº

### Phaser 3 å®˜æ–¹
- [Phaser 3 å®˜æ–¹æ–‡ä»¶](https://photonstorm.github.io/phaser3-docs/)
- [Phaser 3 ç¯„ä¾‹åº«](https://labs.phaser.io/)
- [ç²’å­ç³»çµ± (3.60+)](https://newdocs.phaser.io/docs/3.60.0/focus/Phaser.GameObjects.Particles.ParticleEmitter)

### Tween å‹•ç•«
- [Easing å‡½æ•¸è¦–è¦ºåŒ–](https://easings.net/)
- [Phaser Tween æ–‡ä»¶](https://newdocs.phaser.io/docs/3.60.0/Phaser.Tweens.Tween)

### React + Phaser æ•´åˆ
- [React-Phaser å°ˆæ¡ˆæ¨¡æ¿](https://github.com/photonstorm/phaser3-project-template)

---

## 12. å¾…å®Œæˆä»»å‹™ (Phase 8)

| ä»»å‹™ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| T093 | ç¨‹å¼ç¢¼æ¸…ç†èˆ‡é‡æ§‹ | ä½ |
| T095 | å®Œæ•´ Bundle å„ªåŒ– (< 800KB) | ä¸­ |
| T096 | Phaser è¼‰å…¥å„ªåŒ– (Code Splitting) | ä¸­ |

---

## 13. ç¸½çµ

### æ ¸å¿ƒæˆå°±

1. **å®Œæ•´å ´æ™¯ç³»çµ±**ï¼š4 å€‹ Phaser å ´æ™¯æ¶µè“‹æ•´å€‹æŠ½å¡ â†’ æ­ç¤º â†’ æ…¶ç¥æµç¨‹
2. **é›¶å¤–éƒ¨è³‡æºä¾è³´**ï¼šä½¿ç”¨ Graphics API å‹•æ…‹ç”Ÿæˆæ‰€æœ‰ç²’å­æè³ª
3. **é›™å‘é€šè¨Šæ©‹æ¥**ï¼šEventBridge å¯¦ç¾ React â†” Phaser è§£è€¦
4. **ç¨€æœ‰åº¦å·®ç•°åŒ–**ï¼šæ¯å€‹ç¨€æœ‰åº¦æœ‰ç¨ç‰¹çš„è¦–è¦ºæ•ˆæœ
5. **æ•ˆèƒ½å„ªåŒ–**ï¼šç²’å­æ•¸é‡æ§åˆ¶ã€åŠæ™‚éŠ·æ¯€ã€æ‡¶è¼‰å…¥

### æŠ€è¡“æ£§

- **Phaser 3.60+**ï¼šéŠæˆ²å¼•æ“
- **TypeScript**ï¼šå‹åˆ¥å®‰å…¨
- **Next.js**ï¼šå‹•æ…‹è¼‰å…¥
- **Framer Motion**ï¼šReact å±¤å‹•ç•«

### ç¨‹å¼ç¢¼è¡Œæ•¸çµ±è¨ˆ

| æª”æ¡ˆ | è¡Œæ•¸ | èªªæ˜ |
|------|------|------|
| EventBridge.ts | ~200 | é€šè¨Šæ©‹æ¥ |
| PhaserGame.tsx | ~220 | éŠæˆ²ç®¡ç† |
| PreloadScene.ts | ~220 | è³‡æºè¼‰å…¥ |
| DrawScene.ts | ~320 | æŠ½å–å‹•ç•« |
| CardRevealScene.ts | ~260 | å¡ç‰‡æ­ç¤º |
| CelebrationScene.ts | ~350 | æ…¶ç¥å ´æ™¯ |
| **ç¸½è¨ˆ** | **~1,570** | - |

---

**Developer B Phaser ç›¸é—œä»»å‹™ï¼š100% å®Œæˆ âœ…**
